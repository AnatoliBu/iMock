# WireMock Mappings Viewer и Редактор

Инструмент для просмотра и редактирования маппингов WireMock API с фокусом на API Iiko.

## Возможности

- Просмотр всех маппингов WireMock с фильтрацией и поиском
- Классификация маппингов по типам (аутентификация, меню, стоп-листы и т.д.)
- Редактирование маппингов через удобный интерфейс
- Прямое редактирование JSON
- Сохранение изменений обратно на сервер WireMock
- Создание и удаление маппингов
- **Встроенный прокси-сервер для обхода ограничений CORS**

## Использование

### Запуск

1. Убедитесь, что у вас установлен Node.js (рекомендуется) или Python
2. Запустите скрипт `run.sh`:

```bash
./run.sh
```

3. Браузер автоматически откроется с адресом `http://localhost:8000`

> **Примечание**: Для полноценной работы с API без ограничений CORS рекомендуется использовать Node.js. Если Node.js не установлен, скрипт попробует запустить простой Python-сервер, но в этом случае функции редактирования могут не работать из-за ограничений CORS.

### Работа с инструментом

1. Введите URL сервера WireMock (по умолчанию `http://localhost:8080`)
2. Введите токен авторизации (если требуется, по умолчанию `Bearer test`)
3. Нажмите "Загрузить маппинги"
4. Используйте фильтры для поиска нужных маппингов
5. Нажмите на маппинг для просмотра деталей
6. Нажмите "Редактировать" для изменения маппинга

### Редактирование маппингов

Редактор маппингов включает несколько вкладок:

1. **Запрос** - редактирование параметров запроса (метод, URL, заголовки, шаблоны тела)
2. **Ответ** - редактирование ответа (статус, заголовки, тело, задержка)
3. **Метаданные** - редактирование метаданных (имя, приоритет, флаг постоянства)
4. **JSON** - прямое редактирование JSON представления маппинга

После редактирования нажмите "Сохранить" для отправки изменений на сервер WireMock.

## Типы маппингов API Iiko

Инструмент автоматически классифицирует маппинги по типам:

1. **Аутентификация** - маппинги для получения токена авторизации
2. **Меню и номенклатура** - маппинги для получения меню и номенклатуры
3. **Стоп-листы** - маппинги стоп-листов
4. **Доставка и курьеры** - маппинги для работы с доставками и курьерами
5. **Проверка терминалов** - маппинги для проверки статуса терминалов

## Как это работает

### Прокси-сервер для обхода CORS

Инструмент использует встроенный Node.js прокси-сервер для обхода ограничений CORS. Прокси-сервер перенаправляет запросы с браузера на WireMock API и добавляет необходимые заголовки CORS к ответам.

Все запросы к API проходят через прокси по пути `/proxy/wiremock` с параметрами `host` и `port`, указывающими на целевой WireMock сервер.

## Возможные проблемы и решения

### CORS (Cross-Origin Resource Sharing)

Если вы всё же столкнулись с ошибками CORS при работе с инструментом:

1. Убедитесь, что инструмент запущен через скрипт `run.sh` и использует Node.js
2. Если Node.js не установлен, попробуйте установить его или использовать плагин для браузера для отключения CORS (например, "CORS Everywhere" для Firefox или "Allow CORS" для Chrome)

### Ошибки авторизации

Если вы получаете ошибки авторизации при работе с WireMock:

1. Убедитесь, что токен авторизации введен правильно (включая префикс "Bearer")
2. Проверьте, не истек ли срок действия токена
3. Убедитесь, что у вашего пользователя есть необходимые права доступа

## Установка зависимостей

Для полноценной работы инструмента рекомендуется установить Node.js:

### Ubuntu/Debian
```bash
sudo apt-get update
sudo apt-get install nodejs npm
```

### CentOS/RHEL
```bash
sudo yum install nodejs npm
```

### Windows
Скачайте и установите Node.js с официального сайта: https://nodejs.org/

## Дополнительные ресурсы

- [Документация WireMock API](http://wiremock.org/docs/api/)
- [Документация iiko API](https://api-docs.iiko.ru/) 